#!/bin/bash

# Stocks-Lab 首次启动指引
# 运行此脚本将显示启动步骤

cat << 'EOF'

╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║              🎉 Stocks-Lab 项目创建完成！                        ║
║                                                                  ║
║        投资项目只读披露平台 - Django + DRF                       ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝

📦 项目信息
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
位置: ~/Html-Project/Stocks-Lab
文件: 34 个（Python/HTML/文档）
端口: 8002

✨ 已实现功能
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✓ 7 个数据模型（Project/Member/Trade/Balance 等）
✓ 14+ REST API 端点（完整 CRUD + 权限控制）
✓ 9 个响应式前端页面（Mobile-first 设计）
✓ 严格的权限系统（ADMIN/VIEWER 角色）
✓ 审计日志（自动记录关键操作）
✓ Markdown 支持（交易依据）
✓ 净值曲线计算
✓ 附件管理

🚀 快速启动（三选一）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【方式 1】一键启动（最简单，推荐新手）
    ./quickstart.sh
    
    自动完成：虚拟环境、依赖安装、数据库、管理员、启动

【方式 2】使用管理脚本
    ./manage.sh setup      # 初始化项目
    ./manage.sh migrate    # 创建数据库
    ./manage.sh admin      # 创建管理员
    ./manage.sh run        # 启动服务

【方式 3】手动操作（适合熟悉 Django 的用户）
    python3 -m venv venv
    source venv/bin/activate
    pip install -r requirements.txt
    python manage.py migrate
    python manage.py createsuperuser
    python manage.py runserver 0.0.0.0:8002

📝 生成测试数据（可选）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    source venv/bin/activate
    python create_test_data.py
    
    将创建：
    - 管理员账户: admin / admin123
    - 观察者账户: viewer / viewer123
    - 1 个测试项目（含出资、结余、交易数据）

🌐 访问地址
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
前台（用户界面）: http://localhost:8002
后台（管理界面）: http://localhost:8002/admin
API 文档: 见 API_EXAMPLES.md

📚 文档说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
README.md                  完整项目文档（必读）
QUICKSTART.md             快速启动指南
PROJECT_SUMMARY.md        项目交付总结
API_EXAMPLES.md           API 使用示例（含 curl/Python）
DEPLOYMENT_CHECKLIST.md   生产部署检查清单
PROJECT_COMPLETE.md       项目完成说明

🛠️ 常用命令
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
./manage.sh status        查看系统状态
./manage.sh migrate       执行数据库迁移
./manage.sh admin         创建管理员
./manage.sh run           启动开发服务器
./manage.sh backup        备份数据库
./manage.sh clean         清理缓存文件

💡 使用流程示例
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1. 管理员登录后台创建项目
2. 添加项目成员（设置角色：ADMIN/VIEWER）
3. 添加出资记录
4. 前台登录，选择项目
5. 添加日结余（每日更新）
6. 添加交易记录（thesis 必填）
7. 查看净值曲线和统计数据

⚠️ 注意事项
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
• 当前为开发配置，生产环境需修改 SECRET_KEY 和 DEBUG
• VIEWER 角色只能查看，不能添加/修改数据
• 交易记录的 thesis 字段必填（支持 Markdown）
• 日结余的 project+date 组合必须唯一

🎯 下一步建议
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1. 运行 ./quickstart.sh 启动项目
2. 生成测试数据验证功能
3. 阅读 README.md 了解详细功能
4. 根据需求自定义开发
5. 部署到生产环境（参考 DEPLOYMENT_CHECKLIST.md）

📞 获取帮助
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
• 阅读项目文档（6 份详细文档）
• 使用 ./manage.sh 查看可用命令
• 检查日志文件定位问题

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
                     开发完成 ✓ 可立即使用
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

EOF

echo ""
read -p "按回车键开始启动项目，或按 Ctrl+C 取消... " -r
echo ""

# 执行快速启动
./quickstart.sh
