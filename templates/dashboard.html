{% extends 'base.html' %}

{% block page_title %}ä»ªè¡¨ç›˜{% endblock %}

{% block content %}
{% if not projects %}
<div class="card">
    <div class="alert alert-info">
        æ‚¨è¿˜æ²¡æœ‰åŠ å…¥ä»»ä½•é¡¹ç›®ã€‚è¯·è”ç³»ç®¡ç†å‘˜æ·»åŠ æ‚¨åˆ°é¡¹ç›®ä¸­ã€‚
    </div>
</div>
{% else %}

<!-- é¡¹ç›®é€‰æ‹© -->
<div class="card">
    <div class="card-title">é¡¹ç›®</div>
    <select id="project-selector" class="form-group select" onchange="location.href='?project='+this.value">
        {% for project in projects %}
        <option value="{{ project.id }}" {% if selected_project and selected_project.id == project.id %}selected{% endif %}>
            {{ project.name }}
        </option>
        {% endfor %}
    </select>
</div>

{% if selected_project %}
<!-- ç»Ÿè®¡å¡ç‰‡ -->
<div class="stats-grid">
    <div class="stat-box">
        <div class="stat-label">æœ€æ–°ç»“ä½™</div>
        <div class="stat-value">
            {% if latest_balance %}
            Â¥{{ latest_balance.balance|floatformat:2 }}
            {% else %}
            -
            {% endif %}
        </div>
    </div>
    <div class="stat-box">
        <div class="stat-label">æ›´æ–°æ—¥æœŸ</div>
        <div class="stat-value" style="font-size: 14px;">
            {% if latest_balance %}
            {{ latest_balance.date }}
            {% else %}
            -
            {% endif %}
        </div>
    </div>
</div>

<!-- æœ€è¿‘äº¤æ˜“ -->
<div class="card">
    <div class="card-title">æœ€è¿‘äº¤æ˜“</div>
    {% if recent_trades %}
    {% for trade in recent_trades %}
    <div class="list-item">
        <div class="list-item-title">
            {{ trade.symbol }}
            <span class="badge {% if trade.side == 'BUY' %}badge-success{% else %}badge-danger{% endif %}">
                {{ trade.get_side_display }}
            </span>
        </div>
        <div class="list-item-meta">
            {{ trade.quantity }} è‚¡ @ Â¥{{ trade.price }} | {{ trade.executed_at|date:"Y-m-d H:i" }}
        </div>
    </div>
    {% endfor %}
    <a href="{% url 'trades' selected_project.id %}" class="btn btn-primary btn-block">æŸ¥çœ‹å…¨éƒ¨äº¤æ˜“</a>
    {% else %}
    <div class="alert alert-info">æš‚æ— äº¤æ˜“è®°å½•</div>
    {% endif %}
</div>

<!-- å¿«æ·æ“ä½œ -->
<div class="card">
    <div class="card-title">å¿«æ·æ“ä½œ</div>
    <a href="{% url 'balances' selected_project.id %}" class="btn btn-success btn-block">ğŸ“Š æ—¥ç»“ä½™</a>
    <a href="{% url 'trades' selected_project.id %}" class="btn btn-primary btn-block">ğŸ’° äº¤æ˜“è®°å½•</a>
    <a href="{% url 'contributions' selected_project.id %}" class="btn btn-info btn-block">ğŸ’µ å‡ºèµ„è®°å½•</a>
</div>
{% endif %}

{% endif %}
{% endblock %}
